(this.webpackJsonpattendance=this.webpackJsonpattendance||[]).push([[0],{237:function(e,n,t){"use strict";t.r(n);var o=t(0),a=t.n(o),l=t(91),r=t.n(l),i=t(94);var c=t(50),s=t.n(c);t(230);s.a.initializeApp({apiKey:"AIzaSyCNGVUhArvmU2d-A3c-EwjyDvba2V11loI",authDomain:"attendance-2964a.firebaseapp.com",databaseURL:"https://attendance-2964a.firebaseio.com",projectId:"attendance-2964a",storageBucket:"attendance-2964a.appspot.com",messagingSenderId:"531892612233",appId:"1:531892612233:web:e4373e4b10125686386a58",measurementId:"G-1L4R52SJVK"});var d=s.a,u=t(11),f=function(e){console.log("add to db:",e);var n=e.fields;console.log("to\u6570\u636e\u5e93 : ",n),console.log("\u65f6\u95f4\u6d4b\u8bd5: ",null==n.\u622a\u6b62\u65f6\u95f4fomula),console.log("\u65f6\u95f4\u6d4b\u8bd5: ",null==n.\u62a5\u8bfe\u65f6\u95f4),console.log("\u65f6\u95f4\u6d4b\u8bd5: ",u(null).toDate()),n=function(e){"\u672a\u7ed3\u8bfe"===e.\u662f\u5426\u7ed3\u8bfe?e.\u662f\u5426\u7ed3\u8bfe=!1:e.\u662f\u5426\u7ed3\u8bfe=!0;null==e.\u4f59\u6b3e&&(e.\u4f59\u6b3e="/");null!=e.EnrolDate&&null!=e.\u8bfe\u7a0b\u9884\u8ba1\u65f6\u95f4||(e.EnrolDate=["\u4ecd\u672a\u9009\u62e9"]);null==e.\u8001\u5e08&&(e.\u8001\u5e08=["\u4ecd\u672a\u9009\u62e9"]);null==e.\u8bfe\u7a0b\u9009\u62e9&&(e.\u8bfe\u7a0b=["\u4ecd\u672a\u9009\u62e9"]);return e}(n);var t={attendTime:u(Date.now()).toDate(),airtableId:e.id,balance:n.\u4f59\u6b3e,course:n.\u8bfe\u7a0b[0],created:u(Date.now()).toDate(),studentId:n.Id,studentName:n.name,teacher:n.\u8001\u5e08[0]};null!=n.\u662f\u5426\u7ed3\u8bfe&&(t.isFinished=n.\u662f\u5426\u7ed3\u8bfe),null!=n.\u62a5\u8bfe\u65f6\u95f4&&(t.enrolDate=u(n.\u62a5\u8bfe\u65f6\u95f4).toDate()),null!=n.\u622a\u6b62\u65f6\u95f4fomula&&(t.estimatedFinish=u(n.\u622a\u6b62\u65f6\u95f4fomula).toDate()),console.log(t),function(e){d.firestore().collection("attendance_production").add(e)}(t)};var p=t(9),b=t(10);function g(){var e=Object(p.a)(["\n  outline-style: none;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  padding: 13px 14px;\n  width: 280px;\n  font-size: 14px;\n  font-weight: 700;\n  font-family: 'Microsoft soft';\n"]);return g=function(){return e},e}function m(){var e=Object(p.a)(["\n  width: 100%;\n  display: block;\n  font-family: Tahoma;\n  font-size: 39px;\n  color: #555555;\n  line-height: 1.2;\n  text-align: center;\n"]);return m=function(){return e},e}function v(){var e=Object(p.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  margin-top: -50px;\n  margin-left: -150px;\n"]);return v=function(){return e},e}var h=b.b.div(v()),w=b.b.div(m()),y=b.b.input(g());var D=function(){var e=Object(o.useState)(!1),n=Object(i.a)(e,2),l=n[0],r=n[1];return a.a.createElement("div",null,a.a.createElement(h,null,a.a.createElement(w,null,"\u94a2\u7434\u516c\u5bd3\u7b7e\u5230"),a.a.createElement(y,{autoFocus:!0,onKeyPress:function(e){return function(e,n){var o=e.target.value;if(console.log("input",e.target.which),13===e.which){console.log("\u626b\u7801\u673a"),console.log(o),n(!0),function(e){return new Promise((function(n,t){return e.then((function(e){if(null!=e[0]&&null!=e[0].id){var o=e[0];console.log("result is:",o),n(o)}else t("no student is retrieved from airtable"),window.location.reload()}))}))}(function(e){var n=new(t(27))({apiKey:"key3fX4iWEdGotDwW"}).base("appvWyF7JgnpEYfm2"),o="AND(Id='".concat(e).concat("')");return n("basic").select({filterByFormula:o,view:"RawData"}).firstPage()}(o)).then((function(e){if(null!=e.fields)return function(e){return new Promise((function(n,o){return function(e){var n=new(t(27))({apiKey:"key3fX4iWEdGotDwW"}).base("appvWyF7JgnpEYfm2"),o=e.fields.name;console.log("name: ",o);var a="AND(name='".concat(o).concat("')");return n("\u7b7e\u5230\u8868").select({filterByFormula:a,view:"Grid view",fields:["created","Student"]}).firstPage()}(e).then((function(t){if(console.log("verify: ",t),t.length>0){var a=t[t.length-1].fields.created;console.log("latest: ",a);var l=(new Date).toISOString().substring(0,10);console.log("this date: ",l),l===a&&(console.log("already attended"),window.location.reload(),o("already attended")),console.log("verified"),n(e)}else console.log("new record"),n(e)}))}))}(e);console.log("has no result"),window.location.reload()})).then((function(e){console.log("res is: ",e);var n=e;f(n),function(e){var n=[{fields:{Student:[e]}}];return new(t(27))({apiKey:"key3fX4iWEdGotDwW"}).base("appvWyF7JgnpEYfm2")("\u7b7e\u5230\u8868").create(n)}(n.id).then((function(e){console.log("sign in, record is: ",e),window.location.reload()}))}))}}(e,r)},disabled:l})))};function E(){var e=Object(p.a)(["\n    /* reset.css */\n    html, body, div, span, applet, object, iframe,\n    h1, h2, h3, h4, h5, h6, p, blockquote, pre,\n    a, abbr, acronym, address, big, cite, code,\n    del, dfn, em, img, ins, kbd, q, s, samp,\n    small, strike, strong, sub, sup, tt, var,\n    b, u, i, center,\n    dl, dt, dd, ol, ul, li,\n    fieldset, form, label, legend,\n    table, caption, tbody, tfoot, thead, tr, th, td,\n    article, aside, canvas, details, embed, \n    figure, figcaption, footer, header, hgroup, \n    menu, nav, output, ruby, section, summary,\n    time, mark, audio, video {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        font-size: 100%;\n        font: inherit;\n        vertical-align: baseline;\n    }\n    /* HTML5 display-role reset for older browsers */\n    article, aside, details, figcaption, figure, \n    footer, header, hgroup, menu, nav, section {\n        display: block;\n    }\n    body {\n\n        background-color: #2196F3;\n        line-height: 1;\n    }\n    ol, ul {\n        list-style: none;\n    }\n    blockquote, q {\n        quotes: none;\n    }\n    blockquote:before, blockquote:after,\n    q:before, q:after {\n        content: '';\n        content: none;\n    }\n    table {\n        border-collapse: collapse;\n        border-spacing: 0;\n    }\n"]);return E=function(){return e},e}var k=Object(b.a)(E());var x=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(k,null),a.a.createElement(D,null))};r.a.render(a.a.createElement(x,null),document.getElementById("root"))},97:function(e,n,t){e.exports=t(237)}},[[97,1,2]]]);
//# sourceMappingURL=main.3acd6019.chunk.js.map